

params {

    samplesheet = ''
    downsample = false
    build_seurat = false
    output_path = './'
    cluster = false
}

profiles {
    standard {
        process.executor = 'local'
        docker.enabled = false
        singularity.enabled = false
        apptainer.enabled = false
    }

    singularity {
        docker.enabled = false
        singularity.enabled = true
        apptainer.enabled = false
    }

    docker {
        docker.enabled = true
        singularity.enabled = false
        apptainer.enabled = false
    }

    apptainer {
        docker.enabled = false
        singularity.enabled = false
        apptainer.enabled = true
    }

    oscer {
        process.executor = 'slurm'
        docker.enabled = false
        singularity.enabled = false
        apptainer.enabled = true
        errorStrategy = 'ignore'
        maxRetries = 3
        memory = { 32.G * task.attempt }
        cpus = 4
        time = { 30.m * task.attempt }
    }
}

process {

    withName: create_seurat_object {
        container = {"${projectDir}/envs/images/seurat.sif"}
        // cpus = {executor.name == 'slurm' ? 4 : ""}
        // memory = {executor.name == 'slurm' ? 32.G : ""}
        // time = {executor.name == 'slurm' ? 30.m : ""}
    }

    withName: cluster_seurat {
        container = {"${projectDir}/envs/images/seurat.sif"}
        // cpus = {executor.name == 'slurm' ? 4 : ""}
        // memory = {executor.name == 'slurm' ? 64.G : ""}
        // time = {executor.name == 'slurm' ? 60.m : ""}
    }

}

